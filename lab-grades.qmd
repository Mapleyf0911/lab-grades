---
title: "lab-grades"
author: "JIANG Yufeng"
format: html
---

```{r}
#| message: false
here::i_am("lab-grades.Rproj")
library(here)
library(vroom)
library(ggplot2)
library(tidyr)
library(dplyr)
theme_set(theme_bw())
```

# Q1
```{r}
#| message: false
grades <- vroom(here("data", "grades.csv"))
```
# Q2
|                        |                 |        |
|------------------------|-----------------|--------|
| The data set contains | `r NROW(grades)` | grades |


# Q3
```{r}
grades |>
  distinct(id) |>
  nrow()
```
# Q4
```{r}
students <- grades |>
  distinct(id, group)
students |>
  slice(1:10)
```
# Q5
```{r}
students |>
  group_by(group) |>
  summarise(n = n()) 
ggplot(students, aes(x = group)) +
  geom_bar()
```

# Q6
```{r}
grouped_avg_grades <- grades |>
  filter(course == "Vedic Philosophy and Spirituality") |>
  group_by(group) |>
  summarise(avg_grade = mean(grade, na.rm = TRUE))
grouped_avg_grades

ggplot(grouped_avg_grades, aes(x = group, y = avg_grade)) +
  geom_col(fill = "steelblue") +
  labs(title = "Average Grades in Vedic Philosophy and Spirituality by Group",
       x = "Group",
       y = "Average Grade")
```
# Q7
```{r}
grades |>
  select(semester, grade) |>
  group_by(semester)

ggplot(grades, aes(x = grade)) +
  geom_density() +
  facet_wrap(vars(semester))
```

# Q8
```{r}
student_grades <- grades |> 
  group_by(id, group) |>
  summarise(num_grades = n()) |>
  arrange(id)

student_grades |> 
  slice_head(n = 5) |> 
  knitr::kable()

summary_stats <- student_grades |> 
  summarise(
  min = min(num_grades), 
  max = max(num_grades),
  mean = mean(num_grades),
  median = median(num_grades)
)
```

